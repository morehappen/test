{"version":3,"sources":["../../es6/hotel/hotel-policy.es6"],"names":[],"mappings":"AAAA;AACA;;;;;;IACM,W;AACL,wBAAe;AAAA;AAEd;;AAED;AACA;;;;;;;;;;;;;;;;4BAYW,M,EAAO,Q,EAAS;AAAA;;AAC1B,KAAE,IAAF,CAAO;AACN,UAAM,MADA;AAEN,SAAK,oBAFC;AAGN,UAAM,QAHA;AAIN,aAAU,uBAAQ;AACjB,SAAG,KAAK,MAAL,KAAgB,GAAnB,EAAwB;AACvB,YAAK,eAAL,CAAqB,KAAK,IAA1B,EAA+B,MAA/B;AACA;AACA;AACD,WAAM,GAAN,CAAU,KAAK,GAAf;AACA,KAVK;AAWN,WAAO,uBAAS;AACf,WAAM,GAAN,CAAU,OAAM,MAAN,KAAiB,CAAjB,GAAqB,cAArB,GAAsC,WAAhD;AACA;AAbK,IAAP;AAeA,UAAO,IAAP;AACA;;AAED;;;;kCACiB,I,EAAK,M,EAAQ;AAC7B,OAAI,QAAQ,IAAZ;AAAA,OACC,aAAa,MAAM,WADpB;AAAA,OACiC;AAChC,YAAS,MAAM,cAFhB,CAD6B,CAGG;AAChC,OAAG,EAAE,kBAAkB,KAAlB,IAA2B,OAAO,MAAP,GAAgB,CAA7C,CAAH,EAAmD;AAClD,WAAO,cAAP,CAAuB;AACtB,iBAAY,UADU;AAEtB,aAAQ;AAFc,KAAvB;AAIA;AACA;AACD,OAAI,UAAU,IAAd;AAAA,OACC,MAAM,EADP;AAEA,KAAE,IAAF,CAAO,MAAP,EAAc,UAAC,KAAD,EAAO,IAAP,EAAgB;AAC7B,QAAI,UAAU,KAAK,KAAL,CAAW,GAAX,CAAd;AAAA,QACC,SAAS,SAAT,MAAS,GAAY;AACpB,YAAO;AACN,WAAK,QAAQ,CAAR,CADC;AAEN,kBAAY,QAAQ,CAAR,CAFN,EAEkB;AACxB,aAAO,WAAW,QAAQ,CAAR,CAAX,CAHD;AAIN,mBAAa,WAAW,QAAQ,CAAR,CAAX;AAJP,MAAP;AAMA,KARF;AASA,WAAO,QAAQ,CAAR,IAAa,GAApB;AACA,QAAG,YAAY,IAAf,EAAoB;AACnB,eAAU,QAAV;AACA;AACA;AACD,QAAG,WAAW,QAAQ,CAAR,CAAX,IAAyB,QAAQ,KAApC,EAA0C;AACzC,eAAU,QAAV;AACA;AACD,IAlBD;AAmBA,WAAQ,SAAR,GAAoB,QAAQ,WAAR,GAAsB,CAAtB,GAA0B,CAA1B,GAA8B,CAAlD;AACA,WAAQ,GAAR,GAAc,GAAd;AACA,WAAQ,MAAR,GAAiB,MAAjB;AACA,UAAO,cAAP,CAAuB,OAAvB;AACA","file":"hotel-policy.js","sourcesContent":["/******* 酒店差旅政策 * author:zhanghao * O(∩_∩)O哈哈~ *******/\n'use strict'\nclass HotelPolicy {\n\tconstructor () {\n\n\t}\n\n\t// 获取酒店差旅政策\n\t/*\n\t*\tpara: (type:object)\n\t*\t\tglobal: 全局对象\n\t*\t\tsendData = { // 请求参数\n\t*\t\t\tempidLenvel : 员工id，多个逗号分隔 （12,1212,）\n\t*\t\t\tgeolevel : \t当前城市级别,\n\t*\t\t\tprice : 酒店当前价格,\n\t*\t\t\tcoerceApprove : 是否强制审批 1是 0否\n\t*\t\t}\n\t*\n\t*\n\t* */\n\tgetPolicy (global,sendData){\n\t\t$.ajax({\n\t\t\ttype: \"POST\",\n\t\t\turl: \"/hotel/approveRule\",\n\t\t\tdata: sendData,\n\t\t\tsuccess : data => {\n\t\t\t\tif(data.status === 200) {\n\t\t\t\t\tthis.getStrictPolicy(data.data,global);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tlayer.msg(data.msg);\n\t\t\t},\n\t\t\terror: error => {\n\t\t\t\tlayer.msg(error.status === 0 ? \"确保您的网络畅通，请重试\" : \"服务器异常，请重试\");\n\t\t\t}\n\t\t});\n\t\treturn this;\n\t}\n\n\t// 获得综合差旅政策 （最严格差旅政策）\n\tgetStrictPolicy (data,global) {\n\t\tlet data_ = data,\n\t\t\tcontroller = data_.approveType, // 0 不允许预订，1 审批， 2 只做提醒, -1无需审批\n\t\t\tpolicy = data_.empApproveType; // 差旅政策\n\t\tif(!(policy instanceof Array && policy.length > 0)){\n\t\t\tglobal.policyCallback ({\n\t\t\t\tcontroller: controller,\n\t\t\t\tpolicy: policy\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tlet violate = null,\n\t\t\tids = '';\n\t\t$.each(policy,(index,item) => {\n\t\t\tlet itemArr = item.split(\"-\"),\n\t\t\t\te_data = function () {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tids: itemArr[0],\n\t\t\t\t\t\tcontroller: itemArr[1], // 管控方式\n\t\t\t\t\t\tprice: parseFloat(itemArr[2]),\n\t\t\t\t\t\texceedPrice: parseFloat(itemArr[3])\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\tids += itemArr[0] + \"-\";\n\t\t\tif(violate === null){\n\t\t\t\tviolate = e_data();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(parseFloat(itemArr[2]) < violate.price){\n\t\t\t\tviolate = e_data();\n\t\t\t}\n\t\t});\n\t\tviolate.isViolate = violate.exceedPrice > 0 ? 1 : 0;\n\t\tviolate.ids = ids;\n\t\tviolate.policy = policy;\n\t\tglobal.policyCallback (violate);\n\t}\n\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"]}